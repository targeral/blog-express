"use strict";function textRank(e,t,n){function r(e){var t=0;return e.forEach(function(e){t+=e.weight}),t}function o(t){var n=0;return e[t].in.forEach(function(r){var o=r.index,i=_.find(e[o].out,function(e){return e.index==t});n+=i?i.weight/a[o]*h[o].score:0}),n}var i=n||.85,u=t||200,a=[],h=[];e.forEach(function(e,t){a[t]=r(e.out),h[t]={name:e.name,vertex:t,score:Math.random()}});for(var s=0;u>s;++s)for(var f=0;e.length>f;++f){var p=o(f);h[f].score=1-i+i*p}return h.sort(function(e,t){return t.score-e.score}),h}function sentExGraph(e){function t(e,t){return _.intersection(e,t).length/(Math.log(e.length)+Math.log(t.length))}for(var n=[],r=0;e.length>r;++r)for(var o=r+1;e.length>o;++o){var i=t(e[r],e[o]);n[r]=n[r]||{name:e[r],out:[],"in":[]},n[o]=n[o]||{name:e[o],out:[],"in":[]},n[r].out.push({index:o,weight:i}),n[r].in.push({index:o,weight:i}),n[o].in.push({index:r,weight:i}),n[o].out.push({index:r,weight:i})}return n}function keyExGraph(e,t){function n(e){return h[e]||(h[e]=s++),h[e]-1}for(var r=[],o={},i=e.length,u=t||2,a=u/2,h={},s=1,f=0;i>f;++f){var p=e[f];if(p.pos.match(/^[NJ]/)||"ADJ"===p.pos||"CD"===p.pos)for(var c=Math.max(0,f-a),x=Math.min(i,f+a),d=c;x>d;++d)if(f!=d){var m=e[d];if(m.pos.match(/^[NJ]/)||"ADJ"===m.pos||"CD"===m.pos){var g=[p.term,m.term];g.sort(),g=g.join("____"),o[g]=1}}}for(var v in o){var l=v.split("____");f=n(l[0]),d=n(l[1]),r[f]=r[f]||{me:f,name:l[0],out:[],"in":[]},r[d]=r[d]||{me:d,name:l[1],out:[],"in":[]},r[f].out.push({index:d,weight:1}),r[f].in.push({index:d,weight:1}),r[d].out.push({index:f,weight:1}),r[d].in.push({index:f,weight:1})}return r}if("function"==typeof require&&"object"==typeof exports&&"object"==typeof module)var _=require("lodash");"undefined"!=typeof module&&module.exports&&(module.exports.textRank=textRank,module.exports.keyExGraph=keyExGraph,module.exports.sentExGraph=sentExGraph);